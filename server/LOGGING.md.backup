# AeroSuite Logging Standards

## Overview
AeroSuite uses a centralized, production-grade Winston logger for all application logging. This 
ensures:
- Structured, queryable logs (JSON format)
- Log rotation and retention
- Context-rich logs (requestId, userId, etc.)
- Consistent log levels and usage
- Easy integration with external log aggregators (ELK, Datadog, Sentry, etc.)

__All logs must use the logger in `server/src/infrastructure/logger.js`.__

---

## Log Levels
- `error`: Critical failures, exceptions, or data loss
- `warn`: Recoverable issues, unexpected states
- `info`: Business events, state changes, normal operations
- `debug`: Detailed diagnostic information (dev/test only)

---

## Usage Patterns

### Basic Logging
```js
const logger = require('../infrastructure/logger');
logger.info('User created', { userId: user._id });
logger.error('Failed to process payment', { orderId, error });
```bash

### Logging with Request Context
```js
// In an Express route or middleware:
logger.info('Processing request', logger.withContext({ custom: 'value' }, req));
```bash

### Logging in Error Handlers
```js
logger.error('Unhandled error', logger.withContext({ stack: err.stack }, req));
```bash

### Logging with logWithRequest
```js
logger.logWithRequest(req, 'info', 'User login', { userId: req.user.id });
```bash

---

## Best Practices
- __Always include context__: Use `logger.withContext(meta, req)` or `logger.logWithRequest` to add 
requestId, userId, etc.
- __Use structured metadata__: Pass objects, not string interpolation, for log details.
- __Log at the appropriate level__: Avoid overusing `debug` or `error`.
- __Do not log sensitive data__: Never log passwords, secrets, or PII.
- __Rotate and monitor logs__: Logs are rotated and stored in `logs/`. Monitor disk usage and 
retention.

---

## Extending Logging
- __External Aggregators__: Add a new Winston transport (e.g., Elasticsearch, Datadog, Sentry) in 
`logger.js`.
- __Custom Formats__: Add or modify Winston formats for compliance or custom needs.
- __Security/Audit Logs__: Use `securityEventLogger.js` for compliance/audit events.

---

## Example: Adding a New Transport
```js
const { transports } = require('winston');
logger.add(new transports.Http({
  host: 'log-aggregator.local',
  path: '/logs',
  ssl: true
}));
```bash

---

## References
- [Winston Logger Docs](https://github.com/winstonjs/winston)
- [AeroSuite logger.js](./src/infrastructure/logger.js)
